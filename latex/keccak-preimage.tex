\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\title{keccak preimage}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{tikz,graphicx}
\usepackage[absolute,overlay]{textpos} 
\usetikzlibrary{decorations.pathmorphing,matrix,decorations.pathreplacing,arrows,decorations.markings}
\usetikzlibrary{fit,calc,shapes,arrows,positioning,shadings,backgrounds,patterns,tikzmark,matrix,spy}
\usetikzlibrary{decorations.markings}

\usepackage[T1]{fontenc}
\begin{document}

\maketitle

\section{Introduction}

The observations based on the following paper : \textbf{Linear Structures: Applications to Cryptanalysis of Round-Reduced Keccak}.

\subsection{2R Keccak-512}

See Fig. 8, for each guess :
we set 
\[
    A[0, 1] = A[0, 0] \oplus \alpha_{0}
\]
\[
    A[2, 1] = A[2, 0] \oplus \alpha_{2}
\]
with $\alpha_0$ and $\alpha_2$ as random constants

Since $A[0,0]$ and $A[2,0]$ have 128 bits. So we have a complexity gain over bruteforce of $2^{128}$. Hence the time complexity $= 2^{512 - 128} = 2^{384}$.

Input degree of freedom : 
\begin{enumerate}
    \item 64 bits from $A[0, 0]$ , 64 bits from $A[2,0]$.
    \item (320 -1) bits from white lanes
    \item 128 bits from $\alpha_0, \alpha_2$
\end{enumerate}

This sums upto 575 bits larger than required 512 bits.

\subsection{2R Keccak-384}

\begin{enumerate}
    \item Attack similar to Keccak-512
    \item Can obtain a linear structure of 256 bits variables from 
    \[
        (A[0, 0], A[0, 1], A[2, 0], A[2, 1])
    \]
    
    \item with : $A[0, 2] = A[0, 0] \oplus A[0, 1] \oplus \alpha_0$
    \item and $A[2, 2] = A[2, 0] \oplus A[2, 1] \oplus \alpha_2$
    \item Hence a linear system of 256-bit equations
    \item Msg satisfying padding rule, need a solution with the last bit of A[2,2] being 1
    \item Time Complexity of Attack $ = 2^{384 - 256 + 1} = 2^{129}$
\end{enumerate}

\textbf{Note :} In the following document WM refers to Willi Meier

\section{Suggestion by WM}

\subsection{Mail : 5 Feb}

Mail contents are : 
\begin{quote}
    I mainly refer to : https://eprint.iacr.org/2016/878
    
    We try to loosen restrictions imposed by linear structures to increase freedom degrees.
    
    An example is 2-round Keccak-384. I refer to Fig. 9. In addition to the colored 6 lanes that are variable, we also keep lanes 3,0 and 3,1 variable, still so that sum of columns is kept constant. Then $\chi$ produces one quadratic lane. We substitute quadratic monomials by 64 linear variables.
    
    We can invert the first row of image (green), and we require that the map to the 6-th green lane is linear (i.e. quadratic part happens to vanish). The probability for this event is about $.75^{64} = 2^{27}$

    Then we have $ 4*64 + 64 + 64 = 384$ variables and the same number of conditions. Solving this linear system has about 1 solution, that we may check by substituting it into 2-round Keccak. Genuine number of freedom degrees is 320, and artficial ones 384. It is likely to find a correct solution in $2^{64} * 2^{27}= 2^{91}$ trials. This case was found in discussion with Meicheng Liu and Jian Guo.
    I believe that something similar (or better) will work for 2-round Keccak-512. In addition to substitution of a quadratic lane by linear variables, we know that variables in same column are linearly related. This means that in quadratic lanes after $\chi$, some linear factors  are essentially "the same".

    The probability of a1*a2 =a1*a3 is 0.75 for any values a1, a2, a3. We substitute monomials of the form a1*a2  and a1*a3 by the same linear variable to get more linear equations that will hold true with reasonable probability. We introduce artificial linear variables economically, so that we don't have more linear variables (genuine and artificial ones) than equations.Details need to be checked.
    
    Wonder whether this could also help, e.g., in 3-round Keccak-256 in \url{https://tosc.iacr.org/index.php/ToSC/article/view/802}.
    
    An issue is how far these observations extend to improve 3 round preimages of Keccak-384 and Keccak-512, as described in Sect. 6.3.
    
    As complexities of known preimages of 4-round Keccak-512 are still close to $2^{512}$, there is some slight hope that we might reach 4 rounds for this case.
    
    Do you have any comments on this?
    \end{quote}
    

\end{document}